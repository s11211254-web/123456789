{"entries":[{"timestamp":1759889879382,"editorVersion":"2.0.59","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":131,"diffs":[[1,"<xml xmlns=\"http://www.w3.org/1999/xhtml\">\n  <variables></variables>\n  <block type=\"pxt-on-start\" x=\"0\" y=\"0\"></block>\n</xml>"]]}]},{"type":"edited","filename":"main.ts","patch":[{"start1":0,"length1":4555,"diffs":[[1," "]]}]},{"type":"edited","filename":"pxt.json","patch":[{"start1":202,"length1":31,"diffs":[[1,"    \"additionalFilePaths\": []\n"]]}]}]},{"timestamp":1759890456336,"editorVersion":"2.0.59","changes":[{"type":"edited","filename":"main.ts","patch":[{"start1":0,"length1":37,"diffs":[[1,"// 🎮 MakeCode Arcade 雙人格鬥遊戲（進階版）\n// By ChatGPT GPT-5\n"]]},{"start1":84,"length1":28,"diffs":[[1,"// 🧩 角色設定：名稱、顏色、技能、移動速度、冷卻時間\n"]]},{"start1":503,"length1":159,"diffs":[[1,"// 🎨 顯示角色名稱\n"]]},{"start1":668,"length1":20,"diffs":[[1,"// 🧍‍♂️ Player 1 選擇角色\n"]]},{"start1":1016,"length1":0,"diffs":[[1,"    controller.A.onEvent(ControllerButtonEvent.Pressed, function () { })\n    controller.B.onEvent(ControllerButtonEvent.Pressed, function () { })\n"]]},{"start1":1761,"length1":269,"diffs":[[1,"    info.setLife(5)\n    info.player2.setLife(5)\n"]]},{"start1":1810,"length1":289,"diffs":[[1,"    game.splash(\"開戰！\")\n"]]},{"start1":1836,"length1":11,"diffs":[[1,"// 👾 生成角色\n"]]},{"start1":1984,"length1":109,"diffs":[[1,"        . . . . . . . . . . . .\n        . . . . f f f f . . . .\n        . . . f ${c.color} ${c.color} ${c.color} f . . .\n        . . . . f f f f . . . .\n        . . . . . . . . . . . .\n"]]},{"start1":2526,"length1":18,"diffs":[[1,"// ⚡ 使用技能（含冷卻）\n"]]},{"start1":2837,"length1":78,"diffs":[[1,"            . . . 4 4 4 . .\n            . . 4 4 5 4 4 .\n            . 4 4 5 5 5 4 4\n            . . 4 4 5 4 4 .\n            . . . 4 4 4 . .\n"]]},{"start1":3031,"length1":176,"diffs":[[1,""]]},{"start1":3098,"length1":47,"diffs":[[1,""]]},{"start1":3128,"length1":28,"diffs":[[1,"        player.startEffect(effects.trail, 200)\n"]]},{"start1":3216,"length1":0,"diffs":[[1,"        music.zapped.play()\n"]]},{"start1":3490,"length1":12,"diffs":[[1,"    // 設定冷卻\n"]]},{"start1":3548,"length1":206,"diffs":[[1,"    if (isP1) {\n        p1Cooldown = true\n        pause(cd)\n        p1Cooldown = false\n    } else {\n        p2Cooldown = true\n        pause(cd)\n        p2Cooldown = false\n"]]},{"start1":3725,"length1":62,"diffs":[[1,""]]},{"start1":3728,"length1":11,"diffs":[[1,"// 🧠 技能觸發事件\n"]]},{"start1":4001,"length1":15,"diffs":[[1,"// 💥 碰撞與血量處理\n"]]},{"start1":4107,"length1":53,"diffs":[[1,"    if (target.flags & SpriteFlag.Invisible) return\n"]]},{"start1":4189,"length1":28,"diffs":[[1,"        info.changeLifeBy(-1)\n"]]},{"start1":4287,"length1":28,"diffs":[[1,"        info.player2.changeLifeBy(-1)\n"]]},{"start1":4403,"length1":207,"diffs":[[1,"info.onLifeZero(function () {\n    game.over(false, effects.dissolve)\n"]]},{"start1":4475,"length1":0,"diffs":[[1,"info.player2.onLifeZero(function () {\n    game.over(true, effects.confetti)\n})\n\n"]]}]}]},{"timestamp":1759890884631,"editorVersion":"2.0.59","changes":[{"type":"edited","filename":"main.ts","patch":[{"start1":0,"length1":0,"diffs":[[1,"// 🎮 MakeCode Arcade 雙人格鬥遊戲（穩定可執行版）\n"]]},{"start1":38,"length1":0,"diffs":[[1,"scene.setBackgroundColor(9)\n"]]},{"start1":67,"length1":0,"diffs":[[1,"// 🧩 角色設定：名稱、顏色、技能、速度、冷卻時間\nconst characters = [\n    { name: \"Ninja\", color: 2, skill: \"dash\", speed: 120, cooldown: 1000 },\n    { name: \"Mage\", color: 8, skill: \"fireball\", speed: 80, cooldown: 1500 },\n    { name: \"Robot\", color: 7, skill: \"shield\", speed: 90, cooldown: 2000 }\n]\n\nlet p1Choice = 0\nlet p2Choice = 0\nlet player1: Sprite = null\nlet player2: Sprite = null\nlet p1Cooldown = false\nlet p2Cooldown = false\n\nlet p1HpBar: StatusBarSprite = null\nlet p2HpBar: StatusBarSprite = null\nlet p1CdBar: StatusBarSprite = null\nlet p2CdBar: StatusBarSprite = null\n\n// 🧍‍♂️ 顯示角色\nfunction showCharacter(pIndex: number) {\n    let idx = pIndex == 1 ? p1Choice : p2Choice\n    game.splash(\"P\" + pIndex + \": \" + characters[idx].name)\n}\n\n// 🎯 Player 1 選擇角色\ngame.showLongText(\"Player 1: A=下一個, B=確認\", DialogLayout.Bottom)\ncontroller.A.onEvent(ControllerButtonEvent.Pressed, function () {\n    p1Choice = (p1Choice + 1) % characters.length\n    showCharacter(1)\n})\ncontroller.B.onEvent(ControllerButtonEvent.Pressed, function () {\n    game.splash(\"P1 選擇了 \" + characters[p1Choice].name)\n    player2Select()\n})\n\n// 🧍‍♀️ Player 2 選擇角色\nfunction player2Select() {\n    game.showLongText(\"Player 2: A=下一個, B=確認\", DialogLayout.Bottom)\n    controller.player2.A.onEvent(ControllerButtonEvent.Pressed, function () {\n        p2Choice = (p2Choice + 1) % characters.length\n        showCharacter(2)\n    })\n    controller.player2.B.onEvent(ControllerButtonEvent.Pressed, function () {\n        game.splash(\"P2 選擇了 \" + characters[p2Choice].name)\n        startBattle()\n    })\n}\n\n// ⚔️ 開始戰鬥\nfunction startBattle() {\n    player1 = createPlayer(p1Choice, true)\n    player2 = createPlayer(p2Choice, false)\n\n    // 血量條\n    p1HpBar = statusbars.create(20, 4, StatusBarKind.Health)\n    p2HpBar = statusbars.create(20, 4, StatusBarKind.Health)\n    p1HpBar.attachToSprite(player1, -10, 0)\n    p2HpBar.attachToSprite(player2, -10, 0)\n    p1HpBar.value = 100\n    p2HpBar.value = 100\n\n    // 冷卻條\n    p1CdBar = statusbars.create(20, 3, StatusBarKind.Magic)\n    p2CdBar = statusbars.create(20, 3, StatusBarKind.Magic)\n    p1CdBar.attachToSprite(player1, 0, 6)\n    p2CdBar.attachToSprite(player2, 0, 6)\n    p1CdBar.value = 100\n    p2CdBar.value = 100\n\n    game.splash(\"⚡ 開戰！\")\n}\n\n// 👾 建立角色\nfunction createPlayer(charIndex: number, isPlayer1: boolean): Sprite {\n    let c = characters[charIndex]\n    let p = sprites.create(img`\n        . . . f f f f . . .\n        . . f ${c.color} ${c.color} ${c.color} f . .\n        . . . f f f f . . .\n    `, SpriteKind.Player)\n\n    if (isPlayer1) {\n        controller.moveSprite(p, c.speed, 0)\n        p.x = 30\n    } else {\n        controller.player2.moveSprite(p, c.speed, 0)\n        p.x = 130\n    }\n\n    p.y = 80\n    p.setFlag(SpriteFlag.StayInScreen, true)\n    p.setDataString(\"skill\", c.skill)\n    p.setDataNumber(\"cooldown\", c.cooldown)\n    return p\n}\n\n// ⚡ 技能邏輯（含冷卻條動畫）\nfunction useSkill(player: Sprite, skill: string, isP1: boolean) {\n    if ((isP1 && p1Cooldown) || (!isP1 && p2Cooldown)) {\n        music.buzzer.play()\n        return\n    }\n\n    if (skill == \"fireball\") {\n        let vx = isP1 ? 80 : -80\n        let fire = sprites.createProjectileFromSprite(img`\n            . . 4 4 4 . .\n            . 4 5 5 5 4 .\n            . . 4 4 4 . .\n        `, player, vx, 0)\n        music.pewPew.play()\n        animation.runImageAnimation(fire, [\n            img`. . 4 . .`,\n            img`. 4 5 4 .`,\n            img`. 4 4 5 .`,\n            img`. . 4 4 .`\n        ], 80, true)\n\n    } else if (skill == \"dash\") {\n        let dir = isP1 ? 1 : -1\n        player.startEffect(effects.trail, 200)\n        player.vx = 200 * dir\n        music.zapped.play()\n        pause(200)\n        player.vx = 0\n\n    } else if (skill == \"shield\") {\n        player.startEffect(effects.spray, 1000)\n        player.setFlag(SpriteFlag.Invincible, true)\n        music.powerUp.play()\n        pause(1000)\n        player.setFlag(SpriteFlag.Invincible, false)\n    }\n\n    // 冷卻處理\n    let cd = player.getDataNumber(\"cooldown\")\n    let cdBar = isP1 ? p1CdBar : p2CdBar\n    if (isP1) p1Cooldown = true\n    else p2Cooldown = true\n\n    cdBar.value = 0\n    for (let i = 0; i <= 100; i++) {\n        cdBar.value = i\n        pause(cd / 100)\n    }\n\n    if (isP1) p1Cooldown = false\n    else p2Cooldown = false\n}\n\n"]]}]}]},{"timestamp":1759892465233,"editorVersion":"2.0.59","changes":[{"type":"edited","filename":"main.ts","patch":[{"start1":1,"length1":0,"diffs":[[1,"\n// 🧠 技能觸發\ncontroller.A.onEvent(ControllerButtonEvent.Pressed, function () {\n    useSkill(player1, characters[p1Choice].skill, true)\n})\ncontroller.player2.A.onEvent(ControllerButtonEvent.Pressed, function () {\n    useSkill(player2, characters[p2Choice].skill, false)\n})\n\n// 💥 碰撞與血量條更新\nsprites.onOverlap(SpriteKind.Projectile, SpriteKind.Player, function (projectile, target) {\n    if (target.flags & SpriteFlag.Invincible) return\n\n    if (target == player1) {\n        p1HpBar.value -= 20\n        music.smallCrash.play()\n"]]}]}]},{"timestamp":1759892466413,"editorVersion":"2.0.59","changes":[{"type":"edited","filename":"main.ts","patch":[{"start1":0,"length1":4583,"diffs":[[1,"\n    } else if (target == player2) {\n        p2HpBar.value -= 20\n        music.smallCrash.play()\n    }\n    projectile.destroy()\n})\n\n// 🏁 勝負判定\ngame.onUpdate(function () {\n    if (p1HpBar && p1HpBar.value <= 0) {\n        game.over(false, effects.dissolve)\n    }\n    if (p2HpBar && p2HpBar.value <= 0) {\n        game.over(true, effects.confetti)\n    }\n})\n"]]}]},{"type":"edited","filename":"pxt.json","patch":[{"start1":66,"length1":89,"diffs":[[1,"        \"device\": \"*\"\n"]]}]}]},{"timestamp":1759893333996,"editorVersion":"2.0.59","changes":[{"type":"edited","filename":"main.ts","patch":[{"start1":0,"length1":0,"diffs":[[1,"// ===== 初始化 =====\r\nlet player1: Sprite = null\r\nlet player2: Sprite = null\r\nlet player1Choice = 0\r\nlet player2Choice = 0\r\nlet player1HP = 10\r\nlet player2HP = 10\r\n"]]},{"start1":164,"length1":0,"diffs":[[1,"scene.setBackgroundColor(9)\r\ngame.splash(\"雙人格鬥遊戲\", \"開始選角色\")\r\n"]]},{"start1":227,"length1":0,"diffs":[[1,"// ===== 角色選擇 =====\r\nplayer1Choice = game.askForNumber(\"玩家1選角色: 1=忍者 2=騎士 3=魔法師\", 1)\r\nplayer2Choice = game.askForNumber(\"玩家2選角色: 1=忍者 2=騎士 3=魔法師\", 1)\r\n\r\nfunction createPlayer(choice: number, x: number, y: number): Sprite {\r\n    if (choice == 1) { // 忍者\r\n        let ninja = sprites.create(img`\r\n            . . . . f f f f . . . .\r\n            . . f f f f f f f . . .\r\n            . f f 1 f f f 1 f f . .\r\n            f f f f f f f f f f f .\r\n            f f 1 f f f f f 1 f f .\r\n            . f f f f f f f f f . .\r\n            . . f f f . f f f . . .\r\n        `, SpriteKind.Player)\r\n        ninja.setPosition(x, y)\r\n        return ninja\r\n    } else if (choice == 2) { // 騎士\r\n        let knight = sprites.create(img`\r\n            . . . . 2 2 2 2 . . . .\r\n            . . 2 2 2 2 2 2 2 . . .\r\n            . 2 2 3 2 2 2 3 2 2 . .\r\n            2 2 2 2 2 2 2 2 2 2 2 .\r\n            2 2 3 2 2 2 2 2 3 2 2 .\r\n            . 2 2 2 2 2 2 2 2 2 . .\r\n            . . 2 2 2 . 2 2 2 . . .\r\n        `, SpriteKind.Player)\r\n        knight.setPosition(x, y)\r\n        return knight\r\n    } else { // 魔法師\r\n        let mage = sprites.create(img`\r\n            . . . . 5 5 5 5 . . . .\r\n            . . 5 5 5 5 5 5 5 . . .\r\n            . 5 5 6 5 5 5 6 5 5 . .\r\n            5 5 5 5 5 5 5 5 5 5 5 .\r\n            5 5 6 5 5 5 5 5 6 5 5 .\r\n            . 5 5 5 5 5 5 5 5 5 . .\r\n            . . 5 5 5 . 5 5 5 . . .\r\n        `, SpriteKind.Player)\r\n        mage.setPosition(x, y)\r\n        return mage\r\n    }\r\n}\r\n\r\nplayer1 = createPlayer(player1Choice, 30, 60)\r\nplayer2 = createPlayer(player2Choice, 130, 60)\r\n\r\ncontroller.player1.moveSprite(player1, 100, 0)\r\ncontroller.player2.moveSprite(player2, 100, 0)\r\nplayer1.setStayInScreen(true)\r\nplayer2.setStayInScreen(true)\r\n\r\n"]]}]}]},{"timestamp":1759893411946,"editorVersion":"2.0.59","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":16044,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables></variables><block type=\"pxt-on-start\" x=\"0\" y=\"0\"></block></xml>"]]}]},{"type":"edited","filename":"main.ts","patch":[{"start1":0,"length1":4028,"diffs":[[1,"\r\n\r\ninfo.player1.setLife(player1HP)\r\ninfo.player2.setLife(player2HP)\r\n\r\n// ===== 技能冷卻 =====\r\nlet p1SkillReady = true\r\nlet p2SkillReady = true\r\n\r\ncontroller.player1.onButtonEvent(ControllerButton.A, ControllerButtonEvent.Pressed, function () {\r\n    if (p1SkillReady) {\r\n        useSkill(player1, player1Choice, player2, 1)\r\n        p1SkillReady = false\r\n        pause(1000)\r\n        p1SkillReady = true\r\n    }\r\n})\r\ncontroller.player2.onButtonEvent(ControllerButton.A, ControllerButtonEvent.Pressed, function () {\r\n    if (p2SkillReady) {\r\n        useSkill(player2, player2Choice, player1, 2)\r\n        p2SkillReady = false\r\n        pause(1000)\r\n        p2SkillReady = true\r\n    }\r\n})\r\n\r\n// ===== 技能系統 =====\r\nfunction useSkill(attacker: Sprite, choice: number, defender: Sprite, attackerNum: number) {\r\n    if (choice == 1) { // 忍者：快速攻擊\r\n        attacker.startEffect(effects.trail, 300)\r\n        if (attacker.overlapsWith(defender)) {\r\n            defender.startEffect(effects.fire, 300)\r\n            if (attackerNum == 1) { player2HP -= 2; info.player2.changeLifeBy(-2) }\r\n            else { player1HP -= 2; info.player1.changeLifeBy(-2) }\r\n        }\r\n    } else if (choice == 2) { // 騎士：防禦反擊\r\n        attacker.startEffect(effects.rings, 300)\r\n        if (attacker.overlapsWith(defender)) {\r\n            defender.startEffect(effects.warmRadial, 300)\r\n            if (attackerNum == 1) { player2HP -= 1; info.player2.changeLifeBy(-1) }\r\n            else { player1HP -= 1; info.player1.changeLifeBy(-1) }\r\n        }\r\n    } else if (choice == 3) { // 魔法師：遠程攻擊\r\n        let fireball = sprites.createProjectileFromSprite(img`\r\n            . . 5 5 . .\r\n            . 5 5 5 5 .\r\n            5 5 5 5 5 5\r\n            . 5 5 5 5 .\r\n            . . 5 5 . .\r\n        `, attacker, attacker == player1 ? 50 : -50, 0)\r\n        fireball.startEffect(effects.trail, 300)\r\n        fireball.lifespan = 1000\r\n        fireball.setKind(SpriteKind.Projectile)\r\n        fireball.overlapsWith(defender) ? defender.startEffect(effects.fire, 300) : 0\r\n    }\r\n}\r\n\r\n// ===== 跳躍系統 =====\r\ncontroller.player1.onButtonEvent(ControllerButton.Up, ControllerButtonEvent.Pressed, function () { player1.vy = -50 })\r\ncontroller.player2.onButtonEvent(ControllerButton.Up, ControllerButtonEvent.Pressed, function () { player2.vy = -50 })\r\n\r\ngame.onUpdate(function () {\r\n    player1.vy += 8\r\n    player2.vy += 8\r\n    if (player1.y > 60) { player1.y = 60; player1.vy = 0 }\r\n    if (player2.y > 60) { player2.y = 60; player2.vy = 0 }\r\n\r\n    if (player1HP <= 0) { game.over(false, effects.dissolve) }\r\n    if (player2HP <= 0) { game.over(true, effects.confetti) }\r\n})\r\n"]]}]},{"type":"edited","filename":"pxt.json","patch":[{"start1":267,"length1":38,"diffs":[[1,"      \"preferredEditor\": \"tsprj\"\nprj\"\n"]]}]}]},{"timestamp":1759894025488,"editorVersion":"2.0.59","changes":[{"type":"edited","filename":"main.ts","patch":[{"start1":0,"length1":62,"diffs":[[1,"// ===== JOJO 群星格鬥遊戲完整版 =====\n\n// 遊戲初始化\nscene.setBackgroundImage(img`\n    777777777777777777777777777777\n    777777777777777777777777777777\n    777777777777777777777777777777\n    777777777777777777777777777777\n`)\ngame.splash(\"JOJO群星格鬥\", \"按 A 開始\")\n\nenum Role {\n    NINJA,\n    KNIGHT,\n    MAGE\n}\n\nlet player1Role = Role.NINJA\nlet player2Role = Role.KNIGHT\n\nfunction chooseCharacter(player: number): Role {\n    let choice = game.askForNumber(\"玩家\" + player + \"選角色: 1=忍者 2=騎士 3=魔法師\", 1)\n    if (choice == 1) return Role.NINJA\n    else if (choice == 2) return Role.KNIGHT\n    else return Role.MAGE\n}\n\nplayer1Role = chooseCharacter(1)\nplayer2Role = chooseCharacter(2)\n\ninterface Character {\n    sprite: Sprite,\n    role: Role,\n    skillCooldown: number\n}\n\nfunction createCharacter(role: Role, x: number, y: number): Character {\n    let s: Sprite\n    if (role == Role.NINJA) {\n        s = sprites.create(img`\n            . . . . f f f f . . .\n            . . f f f 1 f f f . .\n            . f f 1 1 1 1 1 f f .\n            f f f 1 f f f 1 f f f\n            f f 1 f f f f f 1 f f\n            . f f f f f f f f f .\n            . . f f . f . f f . .\n        `, SpriteKind.Player)\n    } else if (role == Role.KNIGHT) {\n        s = sprites.create(img`\n            . . . 2 2 2 2 2 . . .\n            . 2 2 3 2 2 2 3 2 2 .\n            2 2 2 2 2 2 2 2 2 2 2\n            2 2 3 2 2 2 2 2 3 2 2\n            . 2 2 2 2 2 2 2 2 2 . .\n            . . 2 2 2 . 2 2 2 . . .\n        `, SpriteKind.Player)\n    } else {\n        s = sprites.create(img`\n            . . . 5 5 5 5 5 . . .\n            . 5 5 6 5 5 5 6 5 5 .\n            5 5 5 5 5 5 5 5 5 5 5\n            5 5 6 5 5 5 5 5 6 5 5\n            . 5 5 5 5 5 5 5 5 5 . .\n            . . 5 5 5 . 5 5 5 . . .\n        `, SpriteKind.Player)\n    }\n    s.setPosition(x, y)\n    s.setFlag(SpriteFlag.StayInScreen, true)\n    return { sprite: s, role: role, skillCooldown: 0 }\n}\n\nlet player1 = createCharacter(player1Role, 30, 60)\nlet player2 = createCharacter(player2Role, 130, 60)\n\ncontroller.player1.moveSprite(player1.sprite, 120, 0)\ncontroller.player2.moveSprite(player2.sprite, 120, 0)\n\n// 血量\ninfo.player1.setLife(100)\ninfo.player2.setLife(100)\n\n// 跳躍\ncontroller.player1.onButtonEvent(ControllerButton.Up, ControllerButtonEvent.Pressed, function () {\n    if (player1.sprite.isHittingTile(CollisionDirection.Bottom)) {\n        player1.sprite.vy = 100\n    }\n})\ncontroller.player2.onButtonEvent(ControllerButton.Up, ControllerButtonEvent.Pressed, function () {\n    if (player2.sprite.isHittingTile(CollisionDirection.Bottom)) {\n        player2.sprite.vy = 100\n    }\n})\n\n// 重力\ngame.onUpdate(function () {\n    player1.sprite.vy += 5\n    player2.sprite.vy += 5\n})\n\n// 技能攻擊\nfunction skillAttack(attacker: Character, defender: Character) {\n    attacker.skillCooldown = 60\n    if (attacker.role == Role.NINJA) {\n        defender.sprite.startEffect(effects.trail, 300)\n        info.player2.changeLifeBy(-20)\n    } else if (attacker.role == Role.KNIGHT) {\n        defender.sprite.startEffect(effects.rings, 300)\n        info.player2.changeLifeBy(-15)\n    } else {\n        let fireball = sprites.createProjectileFromSprite(img`\n            . . 5 5 . .\n            . 5 5 5 5 .\n        `, attacker.sprite, attacker.sprite.x < defender.sprite.x ? 50 : -50, 0)\n        fireball.startEffect(effects.trail, 300)\n        info.player2.changeLifeBy(-25)\n    }\n}\n\ncontroller.player1.onButtonEvent(ControllerButton.A, ControllerButtonEvent.Pressed, function () {\n"]]}]}]},{"timestamp":1759894099271,"editorVersion":"2.0.59","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":21156,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables><variable id=\"sWELS#i.q:I+EfST3Z9Y\">choice</variable><variable id=\"bxEVv6n,NoxDPm7?[sd[\">player1Role</variable><variable id=\"#!m-6~3U!o;:oXa~!Bm0\">player2Role</variable></variables><block type=\"pxt-on-start\" x=\"0\" y=\"0\"><statement name=\"HANDLER\"><block type=\"gamesetbackgroundimage\"><comment pinned=\"false\" h=\"80\" w=\"160\">遊戲初始化</comment><value name=\"img\"><shadow type=\"background_image_picker\"><field name=\"img\">img`\n9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 \n9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 \n9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 \n9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 \n`</field><data>{\"commentRefs\":[],\"fieldData\":{\"img\":null}}</data></shadow></value><next><block type=\"gameSplash\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"1\" _input_init=\"true\"></mutation><value name=\"title\"><shadow type=\"text\"><field name=\"TEXT\">街機格鬥遊戲</field></shadow></value><value name=\"subtitle\"><shadow type=\"text\"><field name=\"TEXT\">按 A 開始</field></shadow></value><next><block type=\"typescript_statement\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" line0=\"enum Role {&#13;\" line1=\"    NINJA,&#13;\" line2=\"    KNIGHT,&#13;\" line3=\"    MAGE&#13;\" line4=\"}\" numlines=\"5\"></mutation><next><block type=\"typescript_statement\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" line0=\"let player1Role = Role.NINJA\" numlines=\"1\" declaredvars=\"player1Role\"></mutation><next><block type=\"typescript_statement\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" line0=\"let player2Role = Role.KNIGHT\" numlines=\"1\" declaredvars=\"player2Role\"></mutation><next><block type=\"variables_set\"><field name=\"VAR\" id=\"bxEVv6n,NoxDPm7?[sd[\">player1Role</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"function_call_output\"><mutation name=\"chooseCharacter\" functionid=\"?ffZl,(lz3P!uelghC/v\"><arg name=\"player\" id=\"1r2drw6ob57r50ohcgr2\" type=\"number\"></arg></mutation><value name=\"1r2drw6ob57r50ohcgr2\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"#!m-6~3U!o;:oXa~!Bm0\">player2Role</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"function_call_output\"><mutation name=\"chooseCharacter\" functionid=\"?ffZl,(lz3P!uelghC/v\"><arg name=\"player\" id=\"1r2drw6ob57r50ohcgr2\" type=\"number\"></arg></mutation><value name=\"1r2drw6ob57r50ohcgr2\"><shadow type=\"math_number\"><field name=\"NUM\">2</field></shadow></value></block></value><next><block type=\"typescript_statement\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" line0=\"interface Character {&#13;\" line1=\"    sprite: Sprite,&#13;\" line2=\"    idleFrames: Image[],&#13;\" line3=\"    walkFrames: Image[],&#13;\" line4=\"    attackFrames: Image[],&#13;\" line5=\"    skillCooldown: number&#13;\" line6=\"}\" numlines=\"7\"></mutation><next><block type=\"typescript_statement\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" line0=\"function createCharacter(role: Role, x: number, y: number): Character {&#13;\" line1=\"    let char: Character&#13;\" line2=\"    if (role == Role.NINJA) {&#13;\" line3=\"        char = {&#13;\" line4=\"            sprite: sprites.create(img`&#13;\" line5=\"                . . . f f f . . .&#13;\" line6=\"                . f f f f f f . .&#13;\" line7=\"            `, SpriteKind.Player),&#13;\" line8=\"            idleFrames: [], walkFrames: [], attackFrames: [], skillCooldown: 0&#13;\" line9=\"        }&#13;\" line10=\"    } else if (role == Role.KNIGHT) {&#13;\" line11=\"        char = {&#13;\" line12=\"            sprite: sprites.create(img`&#13;\" line13=\"                . . . 2 2 2 . . .&#13;\" line14=\"                . 2 2 2 2 2 2 . .&#13;\" line15=\"            `, SpriteKind.Player),&#13;\" line16=\"            idleFrames: [], walkFrames: [], attackFrames: [], skillCooldown: 0&#13;\" line17=\"        }&#13;\" line18=\"    } else {&#13;\" line19=\"        char = {&#13;\" line20=\"            sprite: sprites.create(img`&#13;\" line21=\"                . . . 5 5 5 . . .&#13;\" line22=\"                . 5 5 5 5 5 5 . .&#13;\" line23=\"            `, SpriteKind.Player),&#13;\" line24=\"            idleFrames: [], walkFrames: [], attackFrames: [], skillCooldown: 0&#13;\" line25=\"        }&#13;\" line26=\"    }&#13;\" line27=\"    char.sprite.setPosition(x, y)&#13;\" line28=\"    char.sprite.setFlag(SpriteFlag.StayInScreen, true)&#13;\" line29=\"    return char&#13;\" line30=\"}\" numlines=\"31\"></mutation><next><block type=\"typescript_statement\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" line0=\"let player1 = createCharacter(player1Role, 30, 60)\" numlines=\"1\" declaredvars=\"player1\"></mutation><next><block type=\"typescript_statement\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" line0=\"let player2 = createCharacter(player2Role, 130, 60)\" numlines=\"1\" declaredvars=\"player2\"></mutation><next><block type=\"ctrlgame_control_sprite\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"2\" _input_init=\"true\"></mutation><field name=\"controller\">controller.player1</field><comment pinned=\"false\" h=\"80\" w=\"160\">控制</comment><value name=\"sprite\"><block type=\"typescript_expression\"><field name=\"EXPRESSION\">player1.sprite</field></block></value><value name=\"vx\"><shadow type=\"spriteSpeedPicker\"><field name=\"speed\">120</field></shadow></value><value name=\"vy\"><shadow type=\"spriteSpeedPicker\"><field name=\"speed\">0</field></shadow></value><next><block type=\"ctrlgame_control_sprite\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"2\" _input_init=\"true\"></mutation><field name=\"controller\">controller.player2</field><value name=\"sprite\"><block type=\"typescript_expression\"><field name=\"EXPRESSION\">player2.sprite</field></block></value><value name=\"vx\"><shadow type=\"spriteSpeedPicker\"><field name=\"speed\">120</field></shadow></value><value name=\"vy\"><shadow type=\"spriteSpeedPicker\"><field name=\"speed\">0</field></shadow></value><next><block type=\"pisetlife\"><field name=\"player\">info.player1</field><comment pinned=\"false\" h=\"80\" w=\"160\">血量與技能條</comment><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">100</field></shadow></value><next><block type=\"pisetlife\"><field name=\"player\">info.player2</field><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">100</field></shadow></value><next><block type=\"typescript_statement\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" line0=\"function skillAttack(attacker: Character, defender: Character, role: Role) {&#13;\" line1=\"    attacker.skillCooldown = 60&#13;\" line2=\"    if (role == Role.NINJA) {&#13;\" line3=\"        defender.sprite.startEffect(effects.trail, 300)&#13;\" line4=\"        info.player2.changeLifeBy(-20)&#13;\" line5=\"    } else if (role == Role.KNIGHT) {&#13;\" line6=\"        defender.sprite.startEffect(effects.rings, 300)&#13;\" line7=\"        info.player2.changeLifeBy(-15)&#13;\" line8=\"    } else {&#13;\" line9=\"        let fireball = sprites.createProjectileFromSprite(img`&#13;\" line10=\"            . . 5 5 . .&#13;\" line11=\"            . 5 5 5 5 .&#13;\" line12=\"        `, attacker.sprite, attacker.sprite.x &lt; defender.sprite.x ? 50 : -50, 0)&#13;\" line13=\"        fireball.startEffect(effects.trail, 300)&#13;\" line14=\"        info.player2.changeLifeBy(-25)&#13;\" line15=\"    }&#13;\" line16=\"}\" numlines=\"17\"></mutation></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type=\"ctrlonbuttonevent\" x=\"790\" y=\"0\"><field name=\"controller\">controller.player1</field><field name=\"button\">ControllerButton.A</field><field name=\"event\">ControllerButtonEvent.Pressed</field><comment pinned=\"false\" h=\"80\" w=\"160\">技能觸發</comment><statement name=\"HANDLER\"><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"typescript_expression\"><field name=\"EXPRESSION\">player1.skillCooldown</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"typescript_statement\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" line0=\"skillAttack(player1, player2, player1Role)\" numlines=\"1\"></mutation></block></statement></block></statement></block><block type=\"ctrlonbuttonevent\" x=\"1302\" y=\"0\"><field name=\"controller\">controller.player2</field><field name=\"button\">ControllerButton.A</field><field name=\"event\">ControllerButtonEvent.Pressed</field><statement name=\"HANDLER\"><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"typescript_expression\"><field name=\"EXPRESSION\">player2.skillCooldown</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"typescript_statement\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" line0=\"skillAttack(player2, player1, player2Role)\" numlines=\"1\"></mutation></block></statement></block></statement></block><block type=\"gameupdate\" x=\"1815\" y=\"0\"><comment pinned=\"false\" h=\"80\" w=\"160\">冷卻減少</comment><statement name=\"HANDLER\"><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">GT</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"typescript_expression\"><field name=\"EXPRESSION\">player1.skillCooldown</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"typescript_statement\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" line0=\"player1.skillCooldown--\" numlines=\"1\"></mutation></block></statement><next><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">GT</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"typescript_expression\"><field name=\"EXPRESSION\">player2.skillCooldown</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"typescript_statement\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" line0=\"player2.skillCooldown--\" numlines=\"1\"></mutation></block></statement></block></next></block></statement></block><block type=\"gameupdate\" x=\"2327\" y=\"0\"><comment pinned=\"false\" h=\"80\" w=\"160\">勝利判定</comment><statement name=\"HANDLER\"><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">LTE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"info_PlayerInfo_life\"><field name=\"player\">info.player1</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"gameOver\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"1\" _input_init=\"true\"></mutation><field name=\"effect\">effects.dissolve</field><value name=\"win\"><shadow type=\"toggleWinLose\"><field name=\"win\">false</field></shadow></value></block></statement><next><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">LTE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"info_PlayerInfo_life\"><field name=\"player\">info.player2</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"gameOver\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"1\" _input_init=\"true\"></mutation><field name=\"effect\">effects.confetti</field><value name=\"win\"><shadow type=\"toggleWinLose\"><field name=\"win\">true</field></shadow></value></block></statement></block></next></block></statement></block><block type=\"function_definition\" x=\"2846\" y=\"0\"><mutation name=\"chooseCharacter\" functionid=\"?ffZl,(lz3P!uelghC/v\"><arg name=\"player\" id=\"1r2drw6ob57r50ohcgr2\" type=\"number\"></arg></mutation><field name=\"function_name\">chooseCharacter</field><value name=\"1r2drw6ob57r50ohcgr2\"><block type=\"argument_reporter_number\"><mutation duplicateondrag=\"true\"></mutation><field name=\"VALUE\">player</field></block></value><statement name=\"STACK\"><block type=\"variables_set\"><field name=\"VAR\" id=\"sWELS#i.q:I+EfST3Z9Y\">choice</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"gameaskfornumber\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"1\" _input_init=\"true\"></mutation><value name=\"message\"><shadow type=\"text\"><field name=\"TEXT\"></field></shadow><block type=\"text_join\"><mutation items=\"3\"></mutation><value name=\"ADD0\"><shadow type=\"text\"><field name=\"TEXT\">玩家</field></shadow></value><value name=\"ADD1\"><shadow type=\"text\"><field name=\"TEXT\"></field></shadow><block type=\"argument_reporter_number\"><field name=\"VALUE\">player</field></block></value><value name=\"ADD2\"><shadow type=\"text\"><field name=\"TEXT\">選角色: 1=忍者 2=騎士 3=魔法師</field></shadow></value></block></value><value name=\"answerLength\"><shadow type=\"math_number_minmax\"><mutation min=\"1\" max=\"10\" precision=\"0\"></mutation><field name=\"SLIDER\">1</field></shadow></value></block></value><next><block type=\"controls_if\"><mutation elseif=\"1\" else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"sWELS#i.q:I+EfST3Z9Y\">choice</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"function_return\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" no_return_value=\"false\"></mutation><value name=\"RETURN_VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"typescript_expression\"><field name=\"EXPRESSION\">Role.NINJA</field></block></value></block></statement><value name=\"IF1\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"sWELS#i.q:I+EfST3Z9Y\">choice</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">2</field></shadow></value></block></value><statement name=\"DO1\"><block type=\"function_return\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" no_return_value=\"false\"></mutation><value name=\"RETURN_VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"typescript_expression\"><field name=\"EXPRESSION\">Role.KNIGHT</field></block></value></block></statement><statement name=\"ELSE\"><block type=\"function_return\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" no_return_value=\"false\"></mutation><value name=\"RETURN_VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"typescript_expression\"><field name=\"EXPRESSION\">Role.MAGE</field></block></value></block></statement></block></next></block></statement></block></xml>"]]}]},{"type":"edited","filename":"main.ts","patch":[{"start1":0,"length1":20490,"diffs":[[1,"trollerButton.A, ControllerButtonEvent.Pressed, function () {\n    if (player1.skillCooldown == 0) skillAttack(player1, player2)\n})\ncontroller.player2.onButtonEvent(ControllerButton.A, ControllerButtonEvent.Pressed, function () {\n    if (player2.skillCooldown == 0) skillAttack(player2, player1)\n})\n\n// 冷卻\ngame.onUpdate(function () {\n    if (player1.skillCooldown > 0) player1.skillCooldown--\n    if (player2.skillCooldown > 0) player2.skillCooldown--\n})\n\n// 勝利判定\ngame.onUpdate(function () {\n    if (info.player1.life() <= 0) game.over(false, effects.dissolve)\n    if (info.player2.life() <= 0) game.over(true, effects.confetti)\n})\n"]]}]},{"type":"edited","filename":"pxt.json","patch":[{"start1":274,"length1":35,"diffs":[[1,"    \"preferredEditor\": \"tsprj\"\n"]]}]}]},{"timestamp":1759894696790,"editorVersion":"2.0.59","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":779,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables><variable id=\"gs.^yACITVp]`vUM=)WV\">mySprite</variable><variable type=\"KIND_SpriteKind\" id=\"{(@A~U:MMcLtva/.u)3W\">Player</variable><variable type=\"KIND_SpriteKind\" id=\"D,LGaFY5Z(0)#t0EjeqA\">Projectile</variable><variable type=\"KIND_SpriteKind\" id=\"aa(/|AmI?|J;o?9ylA||\">Food</variable><variable type=\"KIND_SpriteKind\" id=\",d|K7xxB;$4#/sTL@kj;\">Enemy</variable><variable type=\"KIND_SpriteKind\" id=\",fi2rk7~fCj:8t]j{@WB\">StatusBar</variable></variables><block type=\"pxt-on-start\" x=\"35\" y=\"48\"><statement name=\"HANDLER\"><block type=\"gamesetbackgroundimage\"><value name=\"img\"><shadow type=\"background_image_picker\"><field name=\"img\">img`\n"]]},{"start1":20021,"length1":962,"diffs":[[1,"`</field><data>{\"commentRefs\":[],\"fieldData\":{\"img\":null}}</data></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"gs.^yACITVp]`vUM=)WV\">mySprite</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"spritescreate\"><value name=\"img\"><shadow type=\"screen_image_picker\"><field name=\"img\">img`\n"]]},{"start1":20417,"length1":938,"diffs":[[1,". . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n`</field><data>{\"commentRefs\":[],\"fieldData\":{\"img\":null}}</data></shadow></value><value name=\"kind\"><shadow type=\"spritekind\"><field name=\"MEMBER\">Player</field></shadow></value></block></value></block></next></block></statement></block></xml>"]]}]},{"type":"edited","filename":"main.ts","patch":[{"start1":0,"length1":130,"diffs":[[1,""]]},{"start1":19837,"length1":586,"diffs":[[1,"let mySprite = sprites.create(img`\n"]]},{"start1":19909,"length1":0,"diffs":[[1,"    . . . . . . . . . . . . . . . . \n    . . . . . . . . . . . . . . . . \n    . . . . . . . . . . . . . . . . \n    . . . . . . . . . . . . . . . . \n    . . . . . . . . . . . . . . . . \n    . . . . . . . . . . . . . . . . \n    . . . . . . . . . . . . . . . . \n    . . . . . . . . . . . . . . . . \n    . . . . . . . . . . . . . . . . \n    . . . . . . . . . . . . . . . . \n    . . . . . . . . . . . . . . . . \n    . . . . . . . . . . . . . . . . \n    . . . . . . . . . . . . . . . . \n    . . . . . . . . . . . . . . . . \n    . . . . . . . . . . . . . . . . \n"]]}]},{"type":"edited","filename":"pxt.json","patch":[{"start1":245,"length1":120,"diffs":[[1,"        \"assets.json\"\n"]]},{"start1":274,"length1":75,"diffs":[[1,"    \"preferredEditor\": \"blocksprj\"\n"]]}]},{"type":"added","filename":"test.ts","value":"// 在這裡測試；當此封包作為擴充功能時，將不會編譯此內容。\n"},{"type":"added","filename":"tilemap.g.jres","value":"{\n    \"transparency16\": {\n        \"data\": \"hwQQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true\n    },\n    \"tile1\": {\n        \"data\": \"hwQQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true,\n        \"displayName\": \"我的貼圖\"\n    },\n    \"*\": {\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"dataEncoding\": \"base64\",\n        \"namespace\": \"myTiles\"\n    }\n}"},{"type":"added","filename":"tilemap.g.ts","value":"// 自動產生的程式碼。請勿編輯。\nnamespace myTiles {\n    //% fixedInstance jres blockIdentity=images._tile\n    export const transparency16 = image.ofBuffer(hex``);\n    //% fixedInstance jres blockIdentity=images._tile\n    export const tile1 = image.ofBuffer(hex``);\n\n    helpers._registerFactory(\"tile\", function(name: string) {\n        switch(helpers.stringTrim(name)) {\n            case \"transparency16\":return transparency16;\n            case \"我的貼圖\":\n            case \"tile1\":return tile1;\n        }\n        return null;\n    })\n\n}\n// 自動產生的程式碼。請勿編輯。\n"},{"type":"added","filename":"images.g.jres","value":"{\n    \"image1\": {\n        \"data\": \"hwQQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"displayName\": \"我的影像\"\n    },\n    \"*\": {\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"dataEncoding\": \"base64\",\n        \"namespace\": \"myImages\"\n    }\n}"},{"type":"added","filename":"images.g.ts","value":"// 自動產生的程式碼。請勿編輯。\nnamespace myImages {\n\n    helpers._registerFactory(\"image\", function(name: string) {\n        switch(helpers.stringTrim(name)) {\n            case \"image1\":\n            case \"我的影像\":return img`\n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n`;\n        }\n        return null;\n    })\n\n    helpers._registerFactory(\"animation\", function(name: string) {\n        switch(helpers.stringTrim(name)) {\n\n        }\n        return null;\n    })\n\n    helpers._registerFactory(\"song\", function(name: string) {\n        switch(helpers.stringTrim(name)) {\n\n        }\n        return null;\n    })\n\n}\n// 自動產生的程式碼。請勿編輯。\n"}]}],"snapshots":[{"timestamp":1759889879381,"editorVersion":"2.0.59","text":{"main.blocks":"<xml xmlns=\"http://www.w3.org/1999/xhtml\">\n  <variables></variables>\n  <block type=\"pxt-on-start\" x=\"0\" y=\"0\"></block>\n</xml>","main.ts":" ","README.md":" ","assets.json":"","pxt.json":"{\n    \"name\": \"未命名\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"device\": \"*\"\n    },\n    \"files\": [\n        \"main.blocks\",\n        \"main.ts\",\n        \"README.md\",\n        \"assets.json\"\n    ],\n    \"additionalFilePaths\": []\n}\n"}},{"timestamp":1759892465233,"editorVersion":"2.0.59","text":{"main.blocks":"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables></variables><block type=\"pxt-on-start\" x=\"0\" y=\"0\"></block></xml>","main.ts":"// 🎮 MakeCode Arcade 雙人格鬥遊戲（穩定可執行版）\n\nscene.setBackgroundColor(9)\n\n// 🧩 角色設定：名稱、顏色、技能、速度、冷卻時間\nconst characters = [\n    { name: \"Ninja\", color: 2, skill: \"dash\", speed: 120, cooldown: 1000 },\n    { name: \"Mage\", color: 8, skill: \"fireball\", speed: 80, cooldown: 1500 },\n    { name: \"Robot\", color: 7, skill: \"shield\", speed: 90, cooldown: 2000 }\n]\n\nlet p1Choice = 0\nlet p2Choice = 0\nlet player1: Sprite = null\nlet player2: Sprite = null\nlet p1Cooldown = false\nlet p2Cooldown = false\n\nlet p1HpBar: StatusBarSprite = null\nlet p2HpBar: StatusBarSprite = null\nlet p1CdBar: StatusBarSprite = null\nlet p2CdBar: StatusBarSprite = null\n\n// 🧍‍♂️ 顯示角色\nfunction showCharacter(pIndex: number) {\n    let idx = pIndex == 1 ? p1Choice : p2Choice\n    game.splash(\"P\" + pIndex + \": \" + characters[idx].name)\n}\n\n// 🎯 Player 1 選擇角色\ngame.showLongText(\"Player 1: A=下一個, B=確認\", DialogLayout.Bottom)\ncontroller.A.onEvent(ControllerButtonEvent.Pressed, function () {\n    p1Choice = (p1Choice + 1) % characters.length\n    showCharacter(1)\n})\ncontroller.B.onEvent(ControllerButtonEvent.Pressed, function () {\n    game.splash(\"P1 選擇了 \" + characters[p1Choice].name)\n    player2Select()\n})\n\n// 🧍‍♀️ Player 2 選擇角色\nfunction player2Select() {\n    game.showLongText(\"Player 2: A=下一個, B=確認\", DialogLayout.Bottom)\n    controller.player2.A.onEvent(ControllerButtonEvent.Pressed, function () {\n        p2Choice = (p2Choice + 1) % characters.length\n        showCharacter(2)\n    })\n    controller.player2.B.onEvent(ControllerButtonEvent.Pressed, function () {\n        game.splash(\"P2 選擇了 \" + characters[p2Choice].name)\n        startBattle()\n    })\n}\n\n// ⚔️ 開始戰鬥\nfunction startBattle() {\n    player1 = createPlayer(p1Choice, true)\n    player2 = createPlayer(p2Choice, false)\n\n    // 血量條\n    p1HpBar = statusbars.create(20, 4, StatusBarKind.Health)\n    p2HpBar = statusbars.create(20, 4, StatusBarKind.Health)\n    p1HpBar.attachToSprite(player1, -10, 0)\n    p2HpBar.attachToSprite(player2, -10, 0)\n    p1HpBar.value = 100\n    p2HpBar.value = 100\n\n    // 冷卻條\n    p1CdBar = statusbars.create(20, 3, StatusBarKind.Magic)\n    p2CdBar = statusbars.create(20, 3, StatusBarKind.Magic)\n    p1CdBar.attachToSprite(player1, 0, 6)\n    p2CdBar.attachToSprite(player2, 0, 6)\n    p1CdBar.value = 100\n    p2CdBar.value = 100\n\n    game.splash(\"⚡ 開戰！\")\n}\n\n// 👾 建立角色\nfunction createPlayer(charIndex: number, isPlayer1: boolean): Sprite {\n    let c = characters[charIndex]\n    let p = sprites.create(img`\n        . . . f f f f . . .\n        . . f ${c.color} ${c.color} ${c.color} f . .\n        . . . f f f f . . .\n    `, SpriteKind.Player)\n\n    if (isPlayer1) {\n        controller.moveSprite(p, c.speed, 0)\n        p.x = 30\n    } else {\n        controller.player2.moveSprite(p, c.speed, 0)\n        p.x = 130\n    }\n\n    p.y = 80\n    p.setFlag(SpriteFlag.StayInScreen, true)\n    p.setDataString(\"skill\", c.skill)\n    p.setDataNumber(\"cooldown\", c.cooldown)\n    return p\n}\n\n// ⚡ 技能邏輯（含冷卻條動畫）\nfunction useSkill(player: Sprite, skill: string, isP1: boolean) {\n    if ((isP1 && p1Cooldown) || (!isP1 && p2Cooldown)) {\n        music.buzzer.play()\n        return\n    }\n\n    if (skill == \"fireball\") {\n        let vx = isP1 ? 80 : -80\n        let fire = sprites.createProjectileFromSprite(img`\n            . . 4 4 4 . .\n            . 4 5 5 5 4 .\n            . . 4 4 4 . .\n        `, player, vx, 0)\n        music.pewPew.play()\n        animation.runImageAnimation(fire, [\n            img`. . 4 . .`,\n            img`. 4 5 4 .`,\n            img`. 4 4 5 .`,\n            img`. . 4 4 .`\n        ], 80, true)\n\n    } else if (skill == \"dash\") {\n        let dir = isP1 ? 1 : -1\n        player.startEffect(effects.trail, 200)\n        player.vx = 200 * dir\n        music.zapped.play()\n        pause(200)\n        player.vx = 0\n\n    } else if (skill == \"shield\") {\n        player.startEffect(effects.spray, 1000)\n        player.setFlag(SpriteFlag.Invincible, true)\n        music.powerUp.play()\n        pause(1000)\n        player.setFlag(SpriteFlag.Invincible, false)\n    }\n\n    // 冷卻處理\n    let cd = player.getDataNumber(\"cooldown\")\n    let cdBar = isP1 ? p1CdBar : p2CdBar\n    if (isP1) p1Cooldown = true\n    else p2Cooldown = true\n\n    cdBar.value = 0\n    for (let i = 0; i <= 100; i++) {\n        cdBar.value = i\n        pause(cd / 100)\n    }\n\n    if (isP1) p1Cooldown = false\n    else p2Cooldown = false\n}\n\n// 🧠 技能觸發\ncontroller.A.onEvent(ControllerButtonEvent.Pressed, function () {\n    useSkill(player1, characters[p1Choice].skill, true)\n})\ncontroller.player2.A.onEvent(ControllerButtonEvent.Pressed, function () {\n    useSkill(player2, characters[p2Choice].skill, false)\n})\n\n// 💥 碰撞與血量條更新\nsprites.onOverlap(SpriteKind.Projectile, SpriteKind.Player, function (projectile, target) {\n    if (target.flags & SpriteFlag.Invincible) return\n\n    if (target == player1) {\n        p1HpBar.value -= 20\n        music.smallCrash.play()\n    } else if (target == player2) {\n        p2HpBar.value -= 20\n        music.smallCrash.play()\n    }\n    projectile.destroy()\n})\n\n// 🏁 勝負判定\ngame.onUpdate(function () {\n    if (p1HpBar && p1HpBar.value <= 0) {\n        game.over(false, effects.dissolve)\n    }\n    if (p2HpBar && p2HpBar.value <= 0) {\n        game.over(true, effects.confetti)\n    }\n})\n","README.md":" ","assets.json":"","pxt.json":"{\n    \"name\": \"未命名\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"device\": \"*\"\n    },\n    \"files\": [\n        \"main.blocks\",\n        \"main.ts\",\n        \"README.md\",\n        \"assets.json\"\n    ],\n    \"preferredEditor\": \"tsprj\"\n}\n"}},{"timestamp":1759894266915,"editorVersion":"2.0.59","text":{"main.blocks":"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables><variable id=\"sWELS#i.q:I+EfST3Z9Y\">choice</variable><variable id=\"bxEVv6n,NoxDPm7?[sd[\">player1Role</variable><variable id=\"#!m-6~3U!o;:oXa~!Bm0\">player2Role</variable></variables><block type=\"pxt-on-start\" x=\"0\" y=\"0\"><statement name=\"HANDLER\"><block type=\"gamesetbackgroundimage\"><comment pinned=\"false\" h=\"80\" w=\"160\">遊戲初始化</comment><value name=\"img\"><shadow type=\"background_image_picker\"><field name=\"img\">img`\n9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 \n9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 \n9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 \n9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 \n`</field><data>{\"commentRefs\":[],\"fieldData\":{\"img\":null}}</data></shadow></value><next><block type=\"gameSplash\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"1\" _input_init=\"true\"></mutation><value name=\"title\"><shadow type=\"text\"><field name=\"TEXT\">街機格鬥遊戲</field></shadow></value><value name=\"subtitle\"><shadow type=\"text\"><field name=\"TEXT\">按 A 開始</field></shadow></value><next><block type=\"typescript_statement\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" line0=\"enum Role {&#13;\" line1=\"    NINJA,&#13;\" line2=\"    KNIGHT,&#13;\" line3=\"    MAGE&#13;\" line4=\"}\" numlines=\"5\"></mutation><next><block type=\"typescript_statement\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" line0=\"let player1Role = Role.NINJA\" numlines=\"1\" declaredvars=\"player1Role\"></mutation><next><block type=\"typescript_statement\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" line0=\"let player2Role = Role.KNIGHT\" numlines=\"1\" declaredvars=\"player2Role\"></mutation><next><block type=\"variables_set\"><field name=\"VAR\" id=\"bxEVv6n,NoxDPm7?[sd[\">player1Role</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"function_call_output\"><mutation name=\"chooseCharacter\" functionid=\"?ffZl,(lz3P!uelghC/v\"><arg name=\"player\" id=\"1r2drw6ob57r50ohcgr2\" type=\"number\"></arg></mutation><value name=\"1r2drw6ob57r50ohcgr2\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"#!m-6~3U!o;:oXa~!Bm0\">player2Role</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"function_call_output\"><mutation name=\"chooseCharacter\" functionid=\"?ffZl,(lz3P!uelghC/v\"><arg name=\"player\" id=\"1r2drw6ob57r50ohcgr2\" type=\"number\"></arg></mutation><value name=\"1r2drw6ob57r50ohcgr2\"><shadow type=\"math_number\"><field name=\"NUM\">2</field></shadow></value></block></value><next><block type=\"typescript_statement\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" line0=\"interface Character {&#13;\" line1=\"    sprite: Sprite,&#13;\" line2=\"    idleFrames: Image[],&#13;\" line3=\"    walkFrames: Image[],&#13;\" line4=\"    attackFrames: Image[],&#13;\" line5=\"    skillCooldown: number&#13;\" line6=\"}\" numlines=\"7\"></mutation><next><block type=\"typescript_statement\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" line0=\"function createCharacter(role: Role, x: number, y: number): Character {&#13;\" line1=\"    let char: Character&#13;\" line2=\"    if (role == Role.NINJA) {&#13;\" line3=\"        char = {&#13;\" line4=\"            sprite: sprites.create(img`&#13;\" line5=\"                . . . f f f . . .&#13;\" line6=\"                . f f f f f f . .&#13;\" line7=\"            `, SpriteKind.Player),&#13;\" line8=\"            idleFrames: [], walkFrames: [], attackFrames: [], skillCooldown: 0&#13;\" line9=\"        }&#13;\" line10=\"    } else if (role == Role.KNIGHT) {&#13;\" line11=\"        char = {&#13;\" line12=\"            sprite: sprites.create(img`&#13;\" line13=\"                . . . 2 2 2 . . .&#13;\" line14=\"                . 2 2 2 2 2 2 . .&#13;\" line15=\"            `, SpriteKind.Player),&#13;\" line16=\"            idleFrames: [], walkFrames: [], attackFrames: [], skillCooldown: 0&#13;\" line17=\"        }&#13;\" line18=\"    } else {&#13;\" line19=\"        char = {&#13;\" line20=\"            sprite: sprites.create(img`&#13;\" line21=\"                . . . 5 5 5 . . .&#13;\" line22=\"                . 5 5 5 5 5 5 . .&#13;\" line23=\"            `, SpriteKind.Player),&#13;\" line24=\"            idleFrames: [], walkFrames: [], attackFrames: [], skillCooldown: 0&#13;\" line25=\"        }&#13;\" line26=\"    }&#13;\" line27=\"    char.sprite.setPosition(x, y)&#13;\" line28=\"    char.sprite.setFlag(SpriteFlag.StayInScreen, true)&#13;\" line29=\"    return char&#13;\" line30=\"}\" numlines=\"31\"></mutation><next><block type=\"typescript_statement\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" line0=\"let player1 = createCharacter(player1Role, 30, 60)\" numlines=\"1\" declaredvars=\"player1\"></mutation><next><block type=\"typescript_statement\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" line0=\"let player2 = createCharacter(player2Role, 130, 60)\" numlines=\"1\" declaredvars=\"player2\"></mutation><next><block type=\"ctrlgame_control_sprite\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"2\" _input_init=\"true\"></mutation><field name=\"controller\">controller.player1</field><comment pinned=\"false\" h=\"80\" w=\"160\">控制</comment><value name=\"sprite\"><block type=\"typescript_expression\"><field name=\"EXPRESSION\">player1.sprite</field></block></value><value name=\"vx\"><shadow type=\"spriteSpeedPicker\"><field name=\"speed\">120</field></shadow></value><value name=\"vy\"><shadow type=\"spriteSpeedPicker\"><field name=\"speed\">0</field></shadow></value><next><block type=\"ctrlgame_control_sprite\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"2\" _input_init=\"true\"></mutation><field name=\"controller\">controller.player2</field><value name=\"sprite\"><block type=\"typescript_expression\"><field name=\"EXPRESSION\">player2.sprite</field></block></value><value name=\"vx\"><shadow type=\"spriteSpeedPicker\"><field name=\"speed\">120</field></shadow></value><value name=\"vy\"><shadow type=\"spriteSpeedPicker\"><field name=\"speed\">0</field></shadow></value><next><block type=\"pisetlife\"><field name=\"player\">info.player1</field><comment pinned=\"false\" h=\"80\" w=\"160\">血量與技能條</comment><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">100</field></shadow></value><next><block type=\"pisetlife\"><field name=\"player\">info.player2</field><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">100</field></shadow></value><next><block type=\"typescript_statement\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" line0=\"function skillAttack(attacker: Character, defender: Character, role: Role) {&#13;\" line1=\"    attacker.skillCooldown = 60&#13;\" line2=\"    if (role == Role.NINJA) {&#13;\" line3=\"        defender.sprite.startEffect(effects.trail, 300)&#13;\" line4=\"        info.player2.changeLifeBy(-20)&#13;\" line5=\"    } else if (role == Role.KNIGHT) {&#13;\" line6=\"        defender.sprite.startEffect(effects.rings, 300)&#13;\" line7=\"        info.player2.changeLifeBy(-15)&#13;\" line8=\"    } else {&#13;\" line9=\"        let fireball = sprites.createProjectileFromSprite(img`&#13;\" line10=\"            . . 5 5 . .&#13;\" line11=\"            . 5 5 5 5 .&#13;\" line12=\"        `, attacker.sprite, attacker.sprite.x &lt; defender.sprite.x ? 50 : -50, 0)&#13;\" line13=\"        fireball.startEffect(effects.trail, 300)&#13;\" line14=\"        info.player2.changeLifeBy(-25)&#13;\" line15=\"    }&#13;\" line16=\"}\" numlines=\"17\"></mutation></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type=\"ctrlonbuttonevent\" x=\"790\" y=\"0\"><field name=\"controller\">controller.player1</field><field name=\"button\">ControllerButton.A</field><field name=\"event\">ControllerButtonEvent.Pressed</field><comment pinned=\"false\" h=\"80\" w=\"160\">技能觸發</comment><statement name=\"HANDLER\"><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"typescript_expression\"><field name=\"EXPRESSION\">player1.skillCooldown</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"typescript_statement\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" line0=\"skillAttack(player1, player2, player1Role)\" numlines=\"1\"></mutation></block></statement></block></statement></block><block type=\"ctrlonbuttonevent\" x=\"1302\" y=\"0\"><field name=\"controller\">controller.player2</field><field name=\"button\">ControllerButton.A</field><field name=\"event\">ControllerButtonEvent.Pressed</field><statement name=\"HANDLER\"><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"typescript_expression\"><field name=\"EXPRESSION\">player2.skillCooldown</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"typescript_statement\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" line0=\"skillAttack(player2, player1, player2Role)\" numlines=\"1\"></mutation></block></statement></block></statement></block><block type=\"gameupdate\" x=\"1815\" y=\"0\"><comment pinned=\"false\" h=\"80\" w=\"160\">冷卻減少</comment><statement name=\"HANDLER\"><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">GT</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"typescript_expression\"><field name=\"EXPRESSION\">player1.skillCooldown</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"typescript_statement\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" line0=\"player1.skillCooldown--\" numlines=\"1\"></mutation></block></statement><next><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">GT</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"typescript_expression\"><field name=\"EXPRESSION\">player2.skillCooldown</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"typescript_statement\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" line0=\"player2.skillCooldown--\" numlines=\"1\"></mutation></block></statement></block></next></block></statement></block><block type=\"gameupdate\" x=\"2327\" y=\"0\"><comment pinned=\"false\" h=\"80\" w=\"160\">勝利判定</comment><statement name=\"HANDLER\"><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">LTE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"info_PlayerInfo_life\"><field name=\"player\">info.player1</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"gameOver\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"1\" _input_init=\"true\"></mutation><field name=\"effect\">effects.dissolve</field><value name=\"win\"><shadow type=\"toggleWinLose\"><field name=\"win\">false</field></shadow></value></block></statement><next><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">LTE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"info_PlayerInfo_life\"><field name=\"player\">info.player2</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"gameOver\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"1\" _input_init=\"true\"></mutation><field name=\"effect\">effects.confetti</field><value name=\"win\"><shadow type=\"toggleWinLose\"><field name=\"win\">true</field></shadow></value></block></statement></block></next></block></statement></block><block type=\"function_definition\" x=\"2846\" y=\"0\"><mutation name=\"chooseCharacter\" functionid=\"?ffZl,(lz3P!uelghC/v\"><arg name=\"player\" id=\"1r2drw6ob57r50ohcgr2\" type=\"number\"></arg></mutation><field name=\"function_name\">chooseCharacter</field><value name=\"1r2drw6ob57r50ohcgr2\"><block type=\"argument_reporter_number\"><mutation duplicateondrag=\"true\"></mutation><field name=\"VALUE\">player</field></block></value><statement name=\"STACK\"><block type=\"variables_set\"><field name=\"VAR\" id=\"sWELS#i.q:I+EfST3Z9Y\">choice</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"gameaskfornumber\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"1\" _input_init=\"true\"></mutation><value name=\"message\"><shadow type=\"text\"><field name=\"TEXT\"></field></shadow><block type=\"text_join\"><mutation items=\"3\"></mutation><value name=\"ADD0\"><shadow type=\"text\"><field name=\"TEXT\">玩家</field></shadow></value><value name=\"ADD1\"><shadow type=\"text\"><field name=\"TEXT\"></field></shadow><block type=\"argument_reporter_number\"><field name=\"VALUE\">player</field></block></value><value name=\"ADD2\"><shadow type=\"text\"><field name=\"TEXT\">選角色: 1=忍者 2=騎士 3=魔法師</field></shadow></value></block></value><value name=\"answerLength\"><shadow type=\"math_number_minmax\"><mutation min=\"1\" max=\"10\" precision=\"0\"></mutation><field name=\"SLIDER\">1</field></shadow></value></block></value><next><block type=\"controls_if\"><mutation elseif=\"1\" else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"sWELS#i.q:I+EfST3Z9Y\">choice</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"function_return\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" no_return_value=\"false\"></mutation><value name=\"RETURN_VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"typescript_expression\"><field name=\"EXPRESSION\">Role.NINJA</field></block></value></block></statement><value name=\"IF1\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"sWELS#i.q:I+EfST3Z9Y\">choice</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">2</field></shadow></value></block></value><statement name=\"DO1\"><block type=\"function_return\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" no_return_value=\"false\"></mutation><value name=\"RETURN_VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"typescript_expression\"><field name=\"EXPRESSION\">Role.KNIGHT</field></block></value></block></statement><statement name=\"ELSE\"><block type=\"function_return\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" no_return_value=\"false\"></mutation><value name=\"RETURN_VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"typescript_expression\"><field name=\"EXPRESSION\">Role.MAGE</field></block></value></block></statement></block></next></block></statement></block></xml>","main.ts":"// ===== JOJO 群星格鬥遊戲完整版（含跳躍） =====\n\n// 背景\nscene.setBackgroundImage(img`\n    777777777777777777777777777777\n    777777777777777777777777777777\n    777777777777777777777777777777\n    777777777777777777777777777777\n`)\n\n// 選角\nenum Role { NINJA, KNIGHT, MAGE }\nlet player1Role = Role.NINJA\nlet player2Role = Role.KNIGHT\n\nfunction chooseCharacter(player: number): Role {\n    let choice = game.askForNumber(\"玩家\" + player + \"選角色: 1=忍者 2=騎士 3=魔法師\", 1)\n    if (choice == 1) return Role.NINJA\n    else if (choice == 2) return Role.KNIGHT\n    else return Role.MAGE\n}\nplayer1Role = chooseCharacter(1)\nplayer2Role = chooseCharacter(2)\n\n// 角色建立\ninterface Character {\n    sprite: Sprite,\n    role: Role,\n    skillCooldown: number\n}\nfunction createCharacter(role: Role, x: number, y: number): Character {\n    let s: Sprite\n    if (role == Role.NINJA) {\n        s = sprites.create(img`\n            . . . . f f f f . . .\n            . . f f f 1 f f f . .\n            . f f 1 1 1 1 1 f f .\n            f f f 1 f f f 1 f f f\n            f f 1 f f f f f 1 f f\n            . f f f f f f f f f .\n            . . f f . f . f f . .\n        `, SpriteKind.Player)\n    } else if (role == Role.KNIGHT) {\n        s = sprites.create(img`\n            . . . 2 2 2 2 2 . . .\n            . 2 2 3 2 2 2 3 2 2 .\n            2 2 2 2 2 2 2 2 2 2 2\n            2 2 3 2 2 2 2 2 3 2 2\n            . 2 2 2 2 2 2 2 2 2 . .\n            . . 2 2 2 . 2 2 2 . . .\n        `, SpriteKind.Player)\n    } else {\n        s = sprites.create(img`\n            . . . 5 5 5 5 5 . . .\n            . 5 5 6 5 5 5 6 5 5 .\n            5 5 5 5 5 5 5 5 5 5 5\n            5 5 6 5 5 5 5 5 6 5 5\n            . 5 5 5 5 5 5 5 5 5 . .\n            . . 5 5 5 . 5 5 5 . . .\n        `, SpriteKind.Player)\n    }\n    s.setPosition(x, y)\n    s.setFlag(SpriteFlag.StayInScreen, true)\n    return { sprite: s, role: role, skillCooldown: 0 }\n}\n\nlet player1 = createCharacter(player1Role, 30, 60)\nlet player2 = createCharacter(player2Role, 130, 60)\n\n// 控制\ncontroller.player1.moveSprite(player1.sprite, 120, 0)\ncontroller.player2.moveSprite(player2.sprite, 120, 0)\n\n// 血量\ninfo.player1.setLife(100)\ninfo.player2.setLife(100)\n\n// 跳躍\ncontroller.player1.onButtonEvent(ControllerButton.Up, ControllerButtonEvent.Pressed, function () {\n    if (player1.sprite.isHittingTile(CollisionDirection.Bottom)) {\n        player1.sprite.vy = -120\n        animation.runImageAnimation(player1.sprite, [\n            img`\n                . . f f . .\n                . f 1 1 f .\n                f 1 1 1 1 f\n                . f 1 1 f .\n                . . f f . .\n            `\n        ], 100, false)\n    }\n})\ncontroller.player2.onButtonEvent(ControllerButton.Up, ControllerButtonEvent.Pressed, function () {\n    if (player2.sprite.isHittingTile(CollisionDirection.Bottom)) {\n        player2.sprite.vy = -120\n        animation.runImageAnimation(player2.sprite, [\n            img`\n                . . f f . .\n                . f 1 1 f .\n                f 1 1 1 1 f\n                . f 1 1 f .\n                . . f f . .\n            `\n        ], 100, false)\n    }\n})\n\n// 重力\ngame.onUpdate(function () {\n    player1.sprite.vy += 5\n    player2.sprite.vy += 5\n})\n\n// 技能攻擊\nfunction skillAttack(attacker: Character, defender: Character) {\n    attacker.skillCooldown = 60\n    if (attacker.role == Role.NINJA) {\n        defender.sprite.startEffect(effects.trail, 300)\n        info.player2.changeLifeBy(-20)\n    } else if (attacker.role == Role.KNIGHT) {\n        defender.sprite.startEffect(effects.rings, 300)\n        info.player2.changeLifeBy(-15)\n    } else {\n        let fireball = sprites.createProjectileFromSprite(img`\n            . . 5 5 . .\n            . 5 5 5 5 .\n        `, attacker.sprite, attacker.sprite.x < defender.sprite.x ? 50 : -50, 0)\n        fireball.startEffect(effects.trail, 300)\n        info.player2.changeLifeBy(-25)\n    }\n}\n\ncontroller.player1.onButtonEvent(ControllerButton.A, ControllerButtonEvent.Pressed, function () {\n    if (player1.skillCooldown == 0) skillAttack(player1, player2)\n})\ncontroller.player2.onButtonEvent(ControllerButton.A, ControllerButtonEvent.Pressed, function () {\n    if (player2.skillCooldown == 0) skillAttack(player2, player1)\n})\n\n// 冷卻\ngame.onUpdate(function () {\n    if (player1.skillCooldown > 0) player1.skillCooldown--\n    if (player2.skillCooldown > 0) player2.skillCooldown--\n})\n\n// 勝利判定\ngame.onUpdate(function () {\n    if (info.player1.life() <= 0) game.over(false, effects.dissolve)\n    if (info.player2.life() <= 0) game.over(true, effects.confetti)\n})\n\n// 玩家1跳躍\ncontroller.player1.onButtonEvent(ControllerButton.Up, ControllerButtonEvent.Pressed, function () {\n    if (player1.sprite.isHittingTile(CollisionDirection.Bottom)) {\n        player1.sprite.vy = -120\n        animation.runImageAnimation(player1.sprite, [\n            img`\n                . . f f . .\n                . f 1 1 f .\n                f 1 1 1 1 f\n                . f 1 1 f .\n                . . f f . .\n            `,\n            img`\n                . . f f f .\n                . f 1 1 1 f\n                f 1 1 1 1 1\n                . f 1 1 1 f\n                . . f f f .\n            `\n        ], 100, false)\n       \n\n\n// 玩家2跳躍\ncontroller.player2.onButtonEvent(ControllerButton.Up, ControllerButtonEvent.Pressed, function () {\n    if (player2.sprite.isHittingTile(CollisionDirection.Bottom)) {\n        player2.sprite.vy = -120\n        animation.runImageAnimation(player2.sprite, [\n            img`\n                . . f f . .\n                . f 1 1 f .\n                f 1 1 1 1 f\n                . f 1 1 f .\n                . . f f . .\n            `,\n            img`\n                . . f f f .\n                . f 1 1 1 f\n                f 1 1 1 1 1\n                . f 1 1 1 f\n                . . f f f .\n            `\n        ], 100, false)\n      \n","README.md":" ","assets.json":"","pxt.json":"{\n    \"name\": \"未命名 - 複製\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"device\": \"*\",\n        \"pxt-status-bar\": \"github:jwunderl/pxt-status-bar#v0.4.2\"\n    },\n    \"files\": [\n        \"main.blocks\",\n        \"main.ts\",\n        \"README.md\",\n        \"assets.json\"\n    ],\n    \"preferredEditor\": \"tsprj\"\n}\n"}}],"shares":[{"id":"40748-46271-99404-58848","timestamp":1759892806168}],"lastSaveTime":1759894852968}